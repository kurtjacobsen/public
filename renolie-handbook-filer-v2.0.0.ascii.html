<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8">
<title>RENOLIE Handbook (filer) v2.0.0 .ascii.html</title>
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline';">
</head>
<body>
<pre>

RENOLIE Handbook (filer) v2.0.0 .ascii.html
-------------------------------------------
Formaal: Samlet regels&aelig;t for Phase 2. Tidligere v1-regler viderefoeres og praeciseres.

============================================================
A) Grundregler (persist)
============================================================
- ZIP=off (kun hvis udtrykkeligt bedt om). 
- README=off (kun ved konkret behov).
- Start (Render): node renolie-proxy.mjs
- Build (Render): npm install --omit=dev  (brug npm ci KUN hvis lockfile er fastlagt)
- ASCII-only UI: danske bogstaver som HTML-entities (&aelig; &oslash; &aring; &AElig; &Oslash; &Aring;); ingen "smarte" anfuhrsel/streger.
- Anchor=exact filename for alle download-links.
- TZ: Europe/Copenhagen. Al status, tider og dead-lines i CET/CEST.
- Enc-check linje paa UI (Boot Check) skal vises paa foerste skaerm.

============================================================
B) Traad-ritual og kapacitetsstyring
============================================================
- Hver besked: vis "Traadbelastning: X %". Advar ved 70 %, Hard@85 %, Cut@95 %.
- Ny traad start: indsaet Thread-Header v2.0.0 + Thread-Seed v2.0.0 + Meta-Header v2.0.0.
- Ved naeste traad: kopier Handover-Pack v2.0.0 som foerste besked.

============================================================
C) Fil- og deploy-standard
============================================================
- Ultralette *.js-navne (f.eks. u112.js, r101.js). Ingen querystrings (?v=).
- CDN: https://shop96018.sfstatic.io/upload_dir/pics/files
- Proxy: https://renolie-proxy.onrender.com  (mode=direct). /healthz altid tilgaengelig.
- Miljoevariabler: CORS_ORIGIN, MODEL_DEFAULT, ALLOWLIST_FEED_URL, PDF_BACKEND_URL (valgfri indtil M3 prod).

============================================================
D) UI-regler (M1..M5)
============================================================
- Ingen inline scripts (CSP: script-src 'self').
- Brugerflade med help/tooltips og en lille debug-sektion (healthz ping, allowlist count, download log-pointer).
- Autosave af persona via s101 (TTL 30d) aktiveres i M5.
- Format: brug f101 (b/i/link/liste).

============================================================
E) Proxy &amp; Data
============================================================
- a101: SSE + idempotens (requestId) for chat-stream.
- c101: /allowlist henter live XML/JSON, normaliserer til {id,name,url,price}, cache via Redis (TTL 60-720m).
- h101: /healthz rapporterer ok, version, enc=ASCII-only, mode=direct.
- g101: rate-limit paa /pdf/* (typisk 30/min/IP), idem-noegle pr. requestId.

============================================================
F) PDF
============================================================
- q101: recipe schema: { title: string, items: [{label:string, qty?:number, unit?:string}], links?: string[] }.
- p101: rm_b64 payload til /pdf/make; v2.1.0+ understotter NotoSans via URL og enc-line i headeren.
- /pdf/make: POST JSON, svar { ok:true, pdfUrl:"https://..." }. Ved mangler: 400 VALIDATION (title/items).

============================================================
G) Test &amp; DoD/PR
============================================================
- Kontrakt-tests pr. modul (5-8) inkl. timeouts/edge-cases.
- DoD (Definition of Done): Maal opfyldt, test passeret, kode ASCII-renset, healthz OK, dokumenteret i Master-Ledger.
- PR-checkliste: navngivning, filplacering, diff, kort release-note (maks 5 bullets).

============================================================
H) Risiko &amp; afboedning
============================================================
- Dobbelt-stream: a101 idem; forenklet SSE-format (start/data/done).
- Encoding: alt i ASCII indtil PDF-render; fontproof endpoint for NotoSans.
- Performance: Redis-cache for feed; puppeteer reuse; server keep-alive.

</pre>
</body>
</html>
