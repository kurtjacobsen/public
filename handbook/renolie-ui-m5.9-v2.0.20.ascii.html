<!-- renolie-ui-m5.9-v2.0.20.ascii.html -->
<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8">
  <title>RENOLIE UI m5.9 v2.0.20</title>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https: data:; img-src 'self' data: https:; style-src 'unsafe-inline' 'self'; script-src 'self' 'unsafe-inline'; connect-src 'self' https:;">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family: Arial, sans-serif; margin:16px; line-height:1.4}
    h1{font-size:18px;margin:0 0 8px}
    .row{margin:8px 0}
    input,textarea,button{font-size:14px}
    textarea{width:100%;height:140px}
    code,pre{background:#f4f4f4;padding:8px;display:block;white-space:pre-wrap;word-break:break-word}
    .muted{color:#666}
    .chip{display:inline-block;padding:2px 6px;border-radius:12px;background:#eee;margin-left:8px;font-size:12px}
    a.btn{display:inline-block;padding:6px 10px;border:1px solid #ccc;border-radius:6px;text-decoration:none}
  </style>
</head>
<body>
  <h1>RENOLIE UI m5.9 v2.0.20 <span id="impl" class="chip">impl: ?</span></h1>
  <div class="row muted">Enc-check: &aelig; &oslash; &aring; &AElig; &Oslash; &Aring; &deg;</div>

  <div class="row">
    <label for="proxy">Proxy base (https):</label><br>
    <input id="proxy" type="text" style="width:100%" value="https://renolie-proxy.onrender.com">
  </div>

  <div class="row">
    <label for="md">Recipe markdown (valgfri):</label>
    <textarea id="md"># p104 test
- Dette er en T2.5 test
- &aelig; &oslash; &aring;</textarea>
  </div>

  <div class="row">
    <button id="btnMake">Generate PDF</button>
    <a id="btnDownload" class="btn" href="#" target="_blank" rel="noopener">Download PDF</a>
    <button id="btnEcho">Echo demo=1</button>
  </div>

  <div class="row">
    <strong>Response:</strong>
    <pre id="out">(tom)</pre>
  </div>

  <script>
    function show(obj) {
      const out = document.getElementById('out');
      try { out.textContent = JSON.stringify(obj, null, 2); }
      catch { out.textContent = String(obj); }
    }
    function setImpl(s) { document.getElementById('impl').textContent = 'impl: ' + (s || '?'); }

    document.getElementById('btnEcho').addEventListener('click', async () => {
      const base = document.getElementById('proxy').value.trim();
      const url = base.replace(/\/+$/,'') + '/pdf/healthz';
      const r = await fetch(url);
      const j = await r.json();
      setImpl(j && j.impl);
      show(j);
    });

    document.getElementById('btnMake').addEventListener('click', async () => {
      const base = document.getElementById('proxy').value.trim();
      const url = base.replace(/\/+$/,'') + '/pdf/make';
      const md = document.getElementById('md').value;
      const body = md.trim().length ? { recipe_markdown: md } : {};
      const r = await fetch(url, {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify(body)
      });
      const j = await r.json();
      show(j);
      setImpl(j && j.impl);
      if (j && j.ok && j.pdfUrl) {
        document.getElementById('btnDownload').href = j.pdfUrl;
      }
    });
  </script>
</body>
</html>
